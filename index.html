<html>
	<head>	
		<title>Snowgun game</title>
	</head>

	<body>
		<canvas id="canvas" width=400 height=200></canvas>
	</body>
	<script src="js/class.js"></script>
	<script src="js/keyboard.js"></script>
	<script src="js/helper.js"></script>
</html>

<script>

// Initialise canvas
var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');
ctx.imageSmoothingEnabled = false;
ctx.lineWidth = 1;

// Global variables
var gridLen = 20;                       // Each grid 20 pixels
var numWidth = canvas.width/gridLen;    // Number of grids horizontal
var numHeight = canvas.height/gridLen;  // Number of grids vertical


var player;



var peng = new Image();
peng.src = "img/player.png";
var peng2 = new Image();
peng2.src = "img/player2.png";
var block = new Image();
block.src = "img/block.png";
var gunImg = new Image();
gunImg.src = "img/gun.png";
var bg = new Image();
bg.src = "img/bg.png";
var snowball = new Image();
snowball.src = "img/snowball.png";
var wall = new Image();
wall.src = "img/wall.png";


var shoot_snd = document.createElement("audio");
shoot_snd.src = "sound/shoot.mp3";
var die_snd = document.createElement("audio");
die_snd.src = "sound/die.mp3";

var playerArr = [];
var bulletArr = new ObjectArray();
var wallArr = [];

window.onload = function() {

	// Create players
	player = new Player(0, 30, 20, 20, peng, 2, 2, [0, 1], 1, "right");
	player2 = new Player(170, 70, 20, 20, peng2, 2, 2, [0, 1], 2, "left");
	playerArr.push(player);
	playerArr.push(player2);


	//testAnim = new AnimEntity(7, 7, 20, 20, peng, 2, 2, [0, 1]);

	wallArr.push(new Wall(3*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(4*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(5*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(6*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(6*gridLen, 4*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(6*gridLen, 5*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(6*gridLen, 6*gridLen, 20, 20, wall, 1, 1, [0]));

	wallArr.push(new Wall(16*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(15*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(14*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(13*gridLen, 3*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(13*gridLen, 4*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(13*gridLen, 5*gridLen, 20, 20, wall, 1, 1, [0]));
	wallArr.push(new Wall(13*gridLen, 6*gridLen, 20, 20, wall, 1, 1, [0]));

	requestAnimationFrame(gameLoop);
}

// Game loop
function gameLoop() {
	ctx.clearRect(0, 0, canvas.width, canvas.height);
	ctx.drawImage(bg, 0, 0);
	//drawGrids();


	//testAnim.update();

	player.update();
	player2.update();
	


	bulletArr.update();	

	// Update all wall objects
	for (var i = 0; i < wallArr.length; i++) {
		wallArr[i].update();
	}


	requestAnimationFrame(gameLoop);
}

</script>

<style>
#canvas {
	/*border: 3px solid black;*/
	width: 1200px;
	height: 600px;

	image-rendering: pixelated;
}
</style>